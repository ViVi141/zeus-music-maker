# 🎵 宙斯音乐制作器

<div align="center">

![Version](https://img.shields.io/badge/version-v2.0.0-blue.svg)
![Platform](https://img.shields.io/badge/platform-Windows-lightgrey.svg)
![Rust](https://img.shields.io/badge/rust-1.70+-orange.svg)
![License](https://img.shields.io/badge/license-CC--BY--SA--4.0-green.svg)

**专为 Arma 3 设计的专业音乐/视频模组制作工具**

*基于 Rust 构建的高性能多媒体处理平台*

</div>

---

## 📖 项目简介

宙斯音乐制作器是一个功能强大的 Arma 3 模组制作工具，集成了音频解密、格式转换、PAA图片处理和完整的模组生成功能。无论是音乐模组还是视频模组，都能轻松制作出专业的 Arma 3 模组。

### ✨ 核心特性

- 🎵 **音频解密**: 支持酷狗KGM和网易云NCM格式解密
- 🎼 **智能转换**: 基于FFmpeg的多格式音频/视频转换（自动下载FFmpeg）
- 🎬 **视频支持**: 支持视频模组制作，智能分片并行处理
- 🖼️ **PAA转换**: 智能图片格式转换，支持Arma 3专用PAA格式
- 🎮 **模组生成**: 完整的Arma 3音乐/视频模组制作
- ⚡ **高性能**: 多线程处理、并行转换、分片处理
- 🚀 **智能管理**: 自动检测重复文件，避免重复处理
- 🌐 **多镜像源**: 支持多个FFmpeg下载镜像，提升下载体验
- 🎨 **现代界面**: 基于egui的响应式GUI界面
- 📊 **实时监控**: 详细的进度显示和性能统计

## 🚀 快速开始

### 系统要求
- **操作系统**: Windows 10/11 (64位)
- **内存**: 4GB RAM (推荐8GB)
- **存储**: 200MB 可用空间
- **网络**: 用于FFmpeg自动下载

### 安装使用
1. 下载 `zeus-music-maker.exe`
2. 双击运行即可使用
3. 首次启动会显示新用户指导

### 构建源码
```bash
# 克隆仓库
git clone https://github.com/ViVi141/zeus-music-maker.git
cd zeus-music-maker

# 构建项目
cargo build --release

# 或使用构建脚本（Windows）
build.bat
```

## 📋 使用指南

### 🎵 音乐模组制作

1. **选择模组类型**: 在工具栏选择"音乐模组"
2. **添加音频文件**: 点击底部"添加音频文件"按钮
3. **配置项目**: 点击"文件" → "项目设置"修改模组信息
4. **导出模组**: 点击"导出" → "导出模组"生成Arma 3模组

### 🎬 视频模组制作

1. **选择模组类型**: 在工具栏选择"视频模组"
2. **添加视频文件**: 点击底部"添加视频文件"按钮
3. **配置项目**: 点击"文件" → "项目设置"修改模组信息
4. **导出模组**: 点击"导出" → "导出模组"生成Arma 3模组

### 🔧 工具功能

#### 音频解密
- **支持格式**: 酷狗KGM、网易云NCM
- **使用方法**: 工具 → 音频解密 → 选择文件 → 开始解密
- **输出格式**: 自动检测并输出为原始格式

#### 音频转换
- **输入格式**: MP3, WAV, FLAC, M4A, OGG, AAC等
- **输出格式**: OGG (Arma 3标准格式)
- **智能处理**: 自动下载FFmpeg，并行转换优化

#### 视频转换
- **输入格式**: MP4, AVI, MOV, MKV, WMV, FLV, WEBM, M4V, 3GP, OGV
- **输出格式**: OGV (Arma 3标准格式)
- **高级特性**: 分片并行处理、智能质量调整

#### PAA转换
- **输入格式**: PNG, JPG, JPEG, BMP, TGA
- **输出格式**: PAA (Arma 3专用格式)
- **智能处理**: 自动裁剪到2的次方尺寸、居中裁剪

## 🎯 技术特性

### 高性能处理
- **多线程架构**: 基于crossbeam-channel的高效任务调度
- **并行转换**: 支持多文件同时处理，显著提升处理速度
- **分片处理**: 大文件自动分片并行处理，避免内存溢出
- **智能缓存**: 文件路径缓存，避免重复处理

### 用户体验
- **响应式界面**: 基于egui的现代GUI，支持实时更新
- **进度监控**: 详细的进度显示、速度统计、剩余时间估算
- **错误处理**: 完善的错误提示和日志记录
- **配置持久化**: 自动保存用户设置和项目状态

### 自动化功能
- **FFmpeg管理**: 自动下载、安装、配置FFmpeg
- **格式检测**: 智能识别文件格式，自动选择最佳处理方式
- **重复检测**: 自动检测重复文件，避免重复处理
- **资源管理**: 自动清理临时文件，优化存储空间

## 🔧 技术栈

### 核心技术
- **编程语言**: Rust 1.70+ (高性能、内存安全)
- **GUI框架**: egui 0.27.2 (现代、响应式界面)
- **音频处理**: symphonia 0.5.4 (专业音频解码)
- **视频处理**: FFmpeg (业界标准视频处理)
- **图片处理**: image 0.25 (高质量图片处理)

### 高级特性
- **多线程**: crossbeam-channel 0.5 (高效任务调度)
- **并行处理**: rayon 1.10 (数据并行计算)
- **异步IO**: tokio 1.40 (异步网络和文件操作)
- **配置管理**: serde_json (结构化配置存储)
- **模板引擎**: handlebars 5.1 (动态模组生成)

### 系统集成
- **Windows支持**: winapi 0.3 (原生Windows API)
- **DLL加载**: libloading 0.8 (动态库加载)
- **字体支持**: 自动加载中文字体
- **资源嵌入**: rust-embed 8.4 (内置资源文件)

## 📁 项目结构

```
zeus-music-maker/
├── src/
│   ├── app.rs                          # 主应用程序逻辑
│   ├── main.rs                         # 程序入口点
│   ├── models.rs                       # 数据模型定义
│   ├── ui.rs                          # 用户界面组件
│   ├── audio_decrypt.rs               # 音频解密功能
│   ├── audio_converter.rs             # 音频转换功能
│   ├── video_converter.rs             # 视频转换功能
│   ├── video_chunk_converter.rs       # 视频分片转换
│   ├── video_chunk_parallel_processor.rs # 视频并行处理
│   ├── paa_converter.rs               # PAA转换功能
│   ├── ffmpeg_downloader.rs           # FFmpeg下载管理
│   ├── ffmpeg_plugin.rs               # FFmpeg插件系统
│   ├── parallel_converter.rs          # 并行转换引擎
│   ├── threading.rs                   # 多线程任务管理
│   ├── templates.rs                   # 模组模板生成
│   ├── resource_manager.rs            # 资源管理器
│   ├── embedded.rs                    # 嵌入资源管理
│   └── utils/                         # 工具函数
│       ├── constants.rs               # 常量定义
│       ├── file_utils.rs              # 文件操作工具
│       └── string_utils.rs            # 字符串处理工具
├── templates/                         # 模组模板文件
├── assets/                           # 资源文件
├── lib/                              # 外部库文件
└── target/                           # 构建输出目录
```

## 🎮 支持的格式

### 音频格式
| 类型 | 输入格式 | 输出格式 | 说明 |
|------|----------|----------|------|
| 标准音频 | MP3, WAV, FLAC, M4A, OGG, AAC | OGG | Arma 3标准格式 |
| 加密音频 | KGM (酷狗), NCM (网易云) | 原始格式 | 自动解密 |

### 视频格式
| 类型 | 输入格式 | 输出格式 | 说明 |
|------|----------|----------|------|
| 标准视频 | MP4, AVI, MOV, MKV, WMV, FLV, WEBM, M4V, 3GP | OGV | Arma 3标准格式 |
| 特殊处理 | 大文件自动分片 | OGV | 分片并行处理 |

### 图片格式
| 类型 | 输入格式 | 输出格式 | 说明 |
|------|----------|----------|------|
| 标准图片 | PNG, JPG, JPEG, BMP, TGA | PAA | Arma 3专用格式 |
| 智能处理 | 任意尺寸 | 2的次方尺寸 | 自动裁剪和缩放 |

## 🚀 性能优化

### 构建优化
- **LTO优化**: 链接时优化，减小二进制文件大小
- **代码生成**: 单代码生成单元，最大化优化
- **符号剥离**: 生产环境移除调试符号
- **溢出检查**: 生产环境禁用溢出检查

### 运行时优化
- **高优先级**: Windows下自动设置高进程优先级
- **内存管理**: 智能内存分配和回收
- **CPU优化**: 自动检测CPU核心数，优化线程使用
- **I/O优化**: 大缓冲区，减少系统调用

## 📊 性能指标

### 处理速度
- **音频转换**: 约10-50MB/秒（取决于格式复杂度）
- **视频转换**: 约5-20MB/秒（取决于分辨率和编码）
- **并行处理**: 多文件同时处理，速度提升2-4倍
- **分片处理**: 大文件处理速度提升3-5倍

### 资源使用
- **内存占用**: 基础约50MB，处理时动态增长
- **CPU使用**: 多核心并行，充分利用系统资源
- **磁盘空间**: 临时文件自动清理，最小化占用

## 🔧 开发指南

### 环境设置
```bash
# 安装Rust工具链
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# 安装依赖
cargo install cargo-watch  # 开发时自动重编译

# 运行开发版本
cargo run

# 运行测试
cargo test

# 性能测试
cargo bench
```

### 代码风格
- 遵循Google Rust代码风格
- 使用rustfmt自动格式化
- 使用clippy进行代码检查
- 详细的文档注释

### 贡献指南
1. Fork项目仓库
2. 创建功能分支
3. 提交代码更改
4. 创建Pull Request

## 📄 许可证

本项目基于 [CC-BY-SA-4.0 许可证](LICENSE) 开源。

## 📞 联系方式

**作者**: ViVi141  
**邮箱**: 747384120@qq.com  
**项目地址**: [https://github.com/ViVi141/zeus-music-maker](https://github.com/ViVi141/zeus-music-maker)

---

<div align="center">

**版本**: v2.0.0  
**状态**: 稳定发布 🎉  
**发布日期**: 2025年9月

*让音乐模组制作变得简单而专业*

**⭐ 如果这个项目对你有帮助，请给个Star支持一下！**

</div>